{"version":3,"file":"remotesource.js","sourceRoot":"","sources":["../src/remotesource.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,IAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;AAC/B,IAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,2BAA2B,CAAC,CAAC;AAW5D;IAIE;QACE,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC9B,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;QAClC,IAAI,CAAC,cAAc,GAAG,MAAM,CAAC,cAAc,CAAC;QAC5C,IAAI,CAAC,cAAc,GAAG,MAAM,CAAC,cAAc,CAAC;IAC9C,CAAC;IAGD,8BAAO,GAAP;QACE,4BAA4B;QAC5B,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;QACjC,KAAK,CAAC,QAAQ,CAAC,CAAA;QACf,2BAA2B;QAC3B,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;YACzC,MAAM,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC;SACrD;QACD,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,EAAE;YAC9C,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QACD,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,EAAE;YAC9C,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;SACpD;QACD,OAAO,QAAQ,CAAC;IAClB,CAAC;IAED;;;;SAIK;IACL,iCAAU,GAAV;QACE,IAAM,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CAAC;QAC1C,IAAI,MAAM,CAAC,KAAK,EAAE;YAChB,MAAM,MAAM,CAAC,KAAK,CAAC;SACpB;QACD,OAAO,MAAM,CAAC,MAAM,CAAC;IACvB,CAAC;IAED;;;OAGG;IACG,sCAAe,GAArB,UAAsB,UAAU;;;;;4BAGf,qBAAM,KAAK;6BACvB,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,+BAA+B,GAAG,UAAU,EAAE;4BAClE,IAAI,EAAE;gCACJ,QAAQ,EAAE,IAAI,CAAC,cAAc;gCAC7B,QAAQ,EAAE,IAAI,CAAC,cAAc;6BAC9B;yBACF,CAAC;6BACD,IAAI,CAAC,UAAU,GAAG;4BACjB,IAAI,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;gCAC/B,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC;6BACvC;4BACD,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE;gCACpB,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC;6BACvC;4BACD,0BAA0B;4BAC1B,kCAAkC;4BAClC,kCAAkC;4BAClC,mCAAmC;4BACnC,IAAM,SAAS,GAAG;gCAChB,MAAM,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;gCAC5B,UAAU,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI;gCAC9B,UAAU,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI;gCAC9B,KAAK,EAAE;oCACL,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG;oCAC9B,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI;oCAC9B,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI;iCAC/B;6BACF,CAAC;4BACF,OAAO,SAAS,CAAC;wBACnB,CAAC,CAAC;6BACD,KAAK,CAAC,UAAU,KAAK;4BACpB,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;wBACvB,CAAC,CAAC,EAAA;;wBAhCA,QAAQ,GAAG,SAgCX;wBAEJ,sBAAO,QAAQ,EAAC;;;;KACjB;IACD;;OAEG;IACG,sCAAe,GAArB;;;;;4BACsB,qBAAM,KAAK;6BAC5B,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,iBAAiB,EAAE;4BACvC,IAAI,EAAE;gCACJ,QAAQ,EAAE,IAAI,CAAC,cAAc;gCAC7B,QAAQ,EAAE,IAAI,CAAC,cAAc;6BAC9B;yBACF,CAAC;6BACD,IAAI,CAAC,UAAU,GAAG;4BACjB,IAAI,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,GAAG,EAAE;gCAC/B,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC;6BACvC;4BACD,OAAO,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC;wBACvB,CAAC,CAAC;6BACD,KAAK,CAAC,UAAU,KAAK;4BACpB,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;wBACvB,CAAC,CAAC,EAAA;;wBAfE,WAAW,GAAG,SAehB;wBACJ,sBAAO,WAAW,EAAC;;;;KACpB;IACK,qCAAc,GAApB,UAAqB,EAAM;YAAL,IAAI,UAAA;;;gBACxB,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,eAAe,EAAC,IAAI,CAAC;qBAChD,IAAI,CAAC,UAAU,QAAQ;oBACtB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;gBACxB,CAAC,CAAC;qBACD,KAAK,CAAC,UAAU,KAAK;oBACpB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBACrB,CAAC,CAAC,CAAC;;;;KACJ;IACH,mBAAC;AAAD,CAAC,AApHD,IAoHC;AAED,MAAM,CAAC,OAAO,GAAG;IACb,YAAY,EAAE,YAAY;CAC7B,CAAC","sourcesContent":["export {};\nconst axios = require(\"axios\");\nconst debug = require('debug')('RemoteSource:RemoteSource');\ntype sosetting = {\n  sotype: string;\n  socialuser: string;\n  socialpass: string;\n          proxy: {\n            proxy: string;\n            user: string;\n            pass: string;\n          },\n}\nclass RemoteSource {\n  REMOTEADD: string;\n  REMOTEUSERNAME: string;\n  REMOTEPASSWORD: string;\n  constructor() {\n    const config = this.readenv();\n    this.REMOTEADD = config.REMOTEADD;\n    this.REMOTEUSERNAME = config.REMOTEUSERNAME;\n    this.REMOTEPASSWORD = config.REMOTEPASSWORD;\n  }\n \n\n  readenv() {\n    //read config from .env file\n    let envcofig = this.readConfig();\n    debug(envcofig)\n    //check key exist in object\n    if (!envcofig.hasOwnProperty(\"REMOTEADD\")) {\n      throw new Error(`REMOTEADD not found in .env file`);\n    }\n    if (!envcofig.hasOwnProperty(\"REMOTEUSERNAME\")) {\n      throw new Error(`USERNAME not found in .env file`);\n    }\n    if (!envcofig.hasOwnProperty(\"REMOTEPASSWORD\")) {\n      throw new Error(`PASSWORD not found in .env file`);\n    }\n    return envcofig;\n  }\n\n  /**\n   * read config from .env File\n   *\n   * @returns {object} config\n   * */\n  readConfig() {\n    const result = require(\"dotenv\").config();\n    if (result.error) {\n      throw result.error;\n    }\n    return result.parsed;\n  }\n\n  /**\n   * get response from remote servive\n   * @return object\n   */\n  async getRemoteConfig(campaignId): Promise<sosetting> {\n    // let envconfig = await readenv();\n\n    let sosetvar = await axios\n      .get(this.REMOTEADD + \"/api/getsobyCam/?campaign_id=\" + campaignId, {\n        auth: {\n          username: this.REMOTEUSERNAME,\n          password: this.REMOTEPASSWORD,\n        },\n      })\n      .then(function (res) {\n        if (parseInt(res.status) != 200) {\n          throw new Error(\"code not equal 200\");\n        }\n        if (!res.data.status) {\n          throw new Error(\"code not equal 200\");\n        }\n        // console.log(res.status)\n        // console.log(res.data.data.user)\n        // console.log(res.data.data.pass)\n        // console.log(res.data.data.proxy)\n        const sosetting = {\n          sotype: res.data.data.sotype,\n          socialuser: res.data.data.user,\n          socialpass: res.data.data.pass,\n          proxy: {\n            proxy: res.data.data.proxy.url,\n            user: res.data.data.proxy.user,\n            pass: res.data.data.proxy.pass,\n          },\n        };\n        return sosetting;\n      })\n      .catch(function (error) {\n        console.error(error);\n      });\n\n    return sosetvar;\n  }\n  /**\n   * get campaign from remote servive\n   */\n  async getCampaignlist() {\n    const campignlist = await axios\n      .get(this.REMOTEADD + \"/api/listsotask\", {\n        auth: {\n          username: this.REMOTEUSERNAME,\n          password: this.REMOTEPASSWORD,\n        },\n      })\n      .then(function (res) {\n        if (parseInt(res.status) != 200) {\n          throw new Error(\"code not equal 200\");\n        } \n        return res.data.data;\n      })\n      .catch(function (error) {\n        console.error(error);\n      });\n    return campignlist;\n  }\n  async saveLinkremote({data}) {\n    axios.post(this.REMOTEADD + \"/api/savelink\",data)\n    .then(function (response) {\n      console.log(response);\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n}\n\nmodule.exports = {\n    RemoteSource: RemoteSource,\n};\n"]}